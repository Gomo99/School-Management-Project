@model List<SupportMessage>
@{
    ViewBag.Title = "Support Chat";
    int currentUserID = ViewBag.CurrentUserID;
    int chatWithID = ViewBag.ChatWithID;
}

<div class="chat-container">
    <div class="chat-box">
        @foreach (var msg in Model)
        {
            var senderClass = msg.SenderID == currentUserID ? "sent" : "received";
            <div class="chat-message @senderClass">
                <div class="message-text">@msg.MessageText</div>
                <div class="message-time">@msg.Timestamp.ToShortTimeString()</div>
            </div>
        }
    </div>

    <form method="post" asp-action="SendMessage">
        <input type="hidden" name="receiverId" value="@chatWithID" />
        <div class="chat-input">
            <input type="text" name="messageText" class="form-control" placeholder="Type a message..." required />
            <button type="submit" class="btn btn-primary">Send</button>
        </div>
    </form>
</div>

<style>
    .chat-container {
        max-width: 700px;
        margin: auto;
        border: 1px solid #ccc;
        padding: 10px;
        border-radius: 10px;
        height: 80vh;
        display: flex;
        flex-direction: column;
    }

    .chat-box {
        flex: 1;
        overflow-y: auto;
        padding: 10px;
        background-color: #f5f5f5;
        display: flex;
        flex-direction: column;
    }

    .chat-message {
        margin-bottom: 10px;
        max-width: 75%;
        padding: 8px 12px;
        border-radius: 20px;
    }

    .sent {
        align-self: flex-end;
        background-color: #d1e7dd;
        text-align: right;
    }

    .received {
        align-self: flex-start;
        background-color: #e2e3e5;
        text-align: left;
    }

    .message-time {
        font-size: 0.75rem;
        color: #666;
    }

    .chat-input {
        display: flex;
        gap: 10px;
        margin-top: 10px;
    }
</style>
